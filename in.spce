#LAMMPS input file
#to simulate bulk SPC/E water

#####################################################################
clear

variable	samp_rate 	equal 1
variable	thermo_rate 	equal 1
variable	Wlat		equal 3.1043  #for water density 1.0

variable	run		equal 0

variable	ts		equal 2.0
variable	Tdamp		equal 100*${ts}
variable	myT		equal 298.0

units 		real
atom_style	full

dimension 	3

boundary 	p p p

#############################################################################
#set up potential

variable        convA equal 2.4111e-6  #convert to e*A
variable        convB equal 2.0811e-9  #convert to (e*A)^2/kcal/mol
variable        mapA  equal -5060.4*${convA}
variable        mapB  equal -86225*${convB}

pair_style 	lj/cut/coul/long 9.0
pair_modify 	table 0 table/disp 0 shift yes

bond_style  	harmonic
angle_style 	harmonic

read_data	data.txt
molecule 	spce spce.mol

pair_style 	hybrid/overlay lj/cut/coul/long 9.0 &
		excited/map 7.831 1 388 ${mapA} ${mapB}
pair_modify 	table 0 table/disp 0 shift yes

kspace_style 	pppm 1.0e-6

pair_coeff 	* * lj/cut/coul/long 0.0 0.0
pair_coeff	1 1 lj/cut/coul/long 0.1553 3.166
pair_coeff      * * excited/map

bond_coeff	1 554.13 0.9572
angle_coeff	1 45.769 104.52

#############################################################################
#setup for run
thermo 		${thermo_rate}
thermo_style 	custom step vol temp epair pe etotal press density

timestep 	${ts}
run_style 	verlet

neighbor	2.0 bin
neigh_modify	every 1 delay 3 check yes

fix 		rigid all shake 1.0e-8 100 0 b 1 a 1 t 1 2 mol spce

#############################################################################
#run at NVT

#dump positions only in first batch run
dump 		7 all custom ${samp_rate} dump.lammpstrj id x y z fx fy fz type
dump_modify	7 sort id

fix 		2 all nvt temp ${myT} ${myT} ${Tdamp}
fix_modify	2 energy yes

run 		${run}